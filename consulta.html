<!-- consulta.html -->
<div class="modal-consulta">
  <h2>Consulta Veterinaria ğŸ©º</h2>
  <form id="form-consulta">

    <!-- 1. IDENTIFICACIÃ“N -->
    <fieldset>
      <legend class="fieldset-titulo">ğŸ¶ IdentificaciÃ³n de Mascota</legend>

      <div class="grid-parejas">
        <label>
          <input type="radio" name="consultaType" value="existente" checked />
          Consulta existente
        </label>
        <label>
          <input type="radio" name="consultaType" value="nueva" />
          Consulta nueva (cliente y mascota)
        </label>
      </div>

      <!-- EXISTENTE -->
      <div id="consulta-existente">
        <div class="grid-parejas">
          <label>ğŸ” Nombre Mascota:
            <input type="text" id="consulta-petName" placeholder="Ej. Loki, Pelusaâ€¦" />
          </label>
          <button type="button" class="button-86 small" id="buscar-consulta">Buscar</button>
        </div>
        <ul id="consulta-results-list" class="results-list"></ul>
      </div>

      <!-- NUEVA / EDICIÃ“N -->
      <div id="consulta-nueva" style="display:none; margin-top:1em;">
        <div class="grid-parejas">
          <label>ğŸ‘¤ Propietario:<input type="text" id="ownerName" /></label>
          <label>ğŸ“ TelÃ©fono:<input type="tel" id="ownerPhone" /></label>
          <label>ğŸ“§ Correo:<input type="email" id="ownerEmail" /></label>
          <label>ğŸ¾ Mascota:<input type="text" id="petNameNew" /></label>
          <label>ğŸ§¬ Especie:<input type="text" id="speciesNew" /></label>
          <label>ğŸ• Raza:<input type="text" id="breedNew" /></label>
          <label>ğŸ‚ Edad:<input type="number" id="age" min="0" /></label>
          <label>âš–ï¸ Peso:<input type="number" id="weight" step="0.1" /></label>
          <label>ğŸ’‰ Esterilizado:
            <select id="esterilizado">
              <option>SÃ­</option><option>No</option>
            </select>
          </label>
          <label>ğŸ“ Observaciones:<textarea id="observaciones" rows="2"></textarea></label>
        </div>
        <button type="button" class="button-86" id="update-client-btn">âœï¸ Actualizar Cliente</button>
      </div>
    </fieldset>

    <!-- 2. CONSULTA DETALLADA -->
    <button type="button" class="button-86" id="toggle-avanzado">ğŸ§¬ Consulta Detallada</button>
    <div id="seccion-avanzada" style="display:none; margin-top:1em;">
      <fieldset>
        <legend class="fieldset-titulo">ğŸ“‹ Historial ClÃ­nico Adicional</legend>
        <div class="grid-parejas">
          <label>ğŸ“– Motivo:<textarea id="motivoConsulta"></textarea></label>
          <label>ğŸ¥ Historial MÃ©dico:<textarea id="historialMedico"></textarea></label>
          <label>ğŸ’‰ VacunaciÃ³n:<input type="text" id="vacunacion" /></label>
          <label>ğŸ› DesparasitaciÃ³n:<input type="text" id="desparasitacion" /></label>
          <label>ğŸ¥© AlimentaciÃ³n:<input type="text" id="alimentacion" /></label>
          <label>ğŸ“Š Estado Corporal:<input type="number" id="estadoCorporal" min="1" max="9" /></label>
        </div>
      </fieldset>
    </div>

    <!-- 3. MEDICAMENTOS -->
    <fieldset>
      <legend class="fieldset-titulo">ğŸ’Š Medicamentos Administrados</legend>
      <table id="tabla-meds-consulta">
        <thead>
          <tr>
            <th>Medicamento</th><th>DosificaciÃ³n</th>
            <th>VÃ­a</th><th>Precio</th><th>AcciÃ³n</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <button type="button" class="button-86 small" id="add-med">â• AÃ±adir Medicamento</button>
      <div style="margin-top:1em">
        <strong>Total: $<span id="total-consulta">0.00</span></strong>
      </div>
    </fieldset>

    <!-- 4. GUARDAR -->
    <button type="submit" class="button-86">ğŸ’¾ Guardar Consulta</button>
  </form>
</div>

<style>
  .grid-parejas {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px,1fr));
    gap: 1em;
  }
  .fieldset-titulo {
    background: #bbdefb;
    padding: .5em; border-radius:6px;
    font-weight:bold; font-size:1.1em;
    margin-bottom:1em;
  }
  .button-86 { background:#0288d1; color:#fff; padding:.5em 1.2em; border:none; border-radius:6px; cursor:pointer; margin-top:1em; }
  .button-86.small { padding:.3em .8em; font-size:.85rem; }
  table { width:100%; border-collapse:collapse; margin-top:.5em; }
  th,td { border:1px solid #ccc; padding:.4em; }
  .results-list { list-style:none; padding:0; margin-top:.5em; max-height:8em; overflow-y:auto; }
  .results-list li { padding:.4em; cursor:pointer; }
  .results-list li:hover { background:#e0f7fa; }
</style>
