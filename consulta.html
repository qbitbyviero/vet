<!-- consulta.html -->
<div class="modal-consulta">
  <h2>Consulta Veterinaria 🩺 v8</h2>

  <form id="form-consulta">
    <!-- TIPO DE CONSULTA -->
    <fieldset>
      <legend class="fieldset-titulo">🐶 Identificación de Mascota</legend>
      <label>
        <input type="radio" name="consultaType" value="existente" checked />
        Consulta existente
      </label>
      <label>
        <input type="radio" name="consultaType" value="nueva" />
        Consulta nueva (cliente y mascota)
      </label>

      <!-- BUSCAR EXISTENTE -->
      <div id="consulta-existente" style="margin-top:1em;">
        <label>🔍 Nombre de la Mascota:</label>
        <input type="text" id="consulta-petName" placeholder="Ej. Loki, Pelusa..." />
        <button type="button" class="button-86" id="buscar-consulta">Buscar</button>
        <div id="consulta-result"></div>
      </div>

      <!-- EDICIÓN DE CLIENTE (solo existente) -->
      <div id="cliente-edicion" style="display:none; margin-top:1em;">
        <h4>✏️ Editar Datos del Cliente</h4>
        <div class="grid-parejas">
          <label>👤 Propietario:
            <input type="text" id="edit-ownerName" name="Nombre del propietario" />
          </label>
          <label>📞 Teléfono:
            <input type="tel" id="edit-ownerPhone" name="Número de Teléfono" />
          </label>
          <label>📧 Correo:
            <input type="email" id="edit-ownerEmail" name="Correo" />
          </label>
          <label>🐾 Mascota:
            <input type="text" id="edit-petName" name="Nombre de la mascota" />
          </label>
          <label>🧬 Especie:
            <input type="text" id="edit-species" name="Especie" />
          </label>
          <label>🐕 Raza:
            <input type="text" id="edit-breed" name="Raza" />
          </label>
          <label>🎂 Edad:
            <input type="number" id="edit-age" name="Edad" min="0" />
          </label>
          <label>⚖️ Peso:
            <input type="number" id="edit-weight" name="Peso" step="0.1" />
          </label>
          <label>💉 Esterilizado:
            <select id="edit-sterilized" name="Esterilizado">
              <option value="Sí">Sí</option>
              <option value="No">No</option>
            </select>
          </label>
          <label>📝 Observaciones:
            <textarea id="edit-notes" name="Observaciones" rows="2"></textarea>
          </label>
        </div>
        <button type="button" class="button-86" id="btn-actualizar-cliente">
          ✏️ Actualizar Cliente
        </button>
      </div>

      <!-- NUEVA CONSULTA (cliente+mascota) -->
      <div id="consulta-nueva" style="display:none; margin-top:1em;">
        <div class="grid-parejas">
          <label>👤 Propietario:
            <input type="text" name="Nombre del propietario" />
          </label>
          <label>📞 Teléfono:
            <input type="tel" name="Número de Teléfono" />
          </label>
          <label>📧 Correo:
            <input type="email" name="Correo" />
          </label>
          <label>🐾 Mascota:
            <input type="text" name="Nombre de la mascota" />
          </label>
          <label>🧬 Especie:
            <input type="text" name="Especie" />
          </label>
          <label>🐕 Raza:
            <input type="text" name="Raza" />
          </label>
          <label>🎂 Edad:
            <input type="number" name="Edad" min="0" />
          </label>
          <label>⚖️ Peso:
            <input type="number" name="Peso" step="0.1" />
          </label>
          <label>💉 Esterilizado:
            <select name="Esterilizado">
              <option>Sí</option>
              <option>No</option>
            </select>
          </label>
          <label>📝 Observaciones:
            <textarea name="Observaciones" rows="2"></textarea>
          </label>
        </div>
      </div>
    </fieldset>

    <!-- CONSULTA DETALLADA -->
    <button type="button" class="button-86" id="toggle-avanzado">
      🧬 Consulta Detallada
    </button>
    <div id="seccion-avanzada" style="display:none; margin-top:1em;">
      <fieldset>
        <legend class="fieldset-titulo">📋 Historial Clínico Adicional</legend>
        <div class="grid-parejas">
          <label>📖 Motivo:
            <textarea name="motivoConsulta" rows="2"></textarea>
          </label>
          <label>🏥 Historial Médico:
            <textarea name="historialMedico" rows="2"></textarea>
          </label>
          <label>💉 Vacunación:
            <input type="text" name="vacunacion" />
          </label>
          <label>🐛 Desparasitación:
            <input type="text" name="desparasitacion" />
          </label>
          <label>🥩 Alimentación:
            <input type="text" name="alimentacion" />
          </label>
          <label>📊 Estado Corporal:
            <input type="number" name="estadoCorporal" min="1" max="9" />
          </label>
        </div>
      </fieldset>
    </div>

    <!-- MEDICAMENTOS SUMINISTRADOS -->
    <fieldset style="margin-top:1em;">
      <legend class="fieldset-titulo">💊 Medicamentos Suministrados</legend>
      <table id="med-table" style="width:100%; border-collapse:collapse;">
        <thead>
          <tr>
            <th style="text-align:left;">Medicamento</th>
            <th style="text-align:left;">Cantidad Colocada</th>
            <th style="text-align:left;">Precio</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input type="text" class="med-name" placeholder="Medicamento" /></td>
            <td><input type="text" class="med-qty" placeholder="Cantidad / Dosis (p.ej. 5 gotas, 2 cápsulas)" /></td>
            <td><input type="number" class="med-price" placeholder="Precio" min="0" step="0.01" /></td>
            <td>
              <button type="button" class="button-86 small btn-add-med">+</button>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="2"><strong>Total:</strong></td>
            <td colspan="2"><span id="med-total">0.00</span></td>
          </tr>
        </tfoot>
      </table>
      <input type="hidden" name="medicsuministrados" id="medicsuministrados" />
    </fieldset>

    <!-- INDICACIONES -->
    <fieldset style="margin-top:1em;">
      <legend class="fieldset-titulo">📝 Indicaciones</legend>
      <textarea name="indicaciones" id="indicaciones" rows="3" style="width:100%;"></textarea>
    </fieldset>

    <!-- GUARDAR CONSULTA -->
    <button type="submit" class="button-86" style="margin-top:1em;">💾 Guardar Consulta</button>
  </form>
</div>

<style>
  .modal-consulta { padding:1em; border-radius:10px; background:#e3f2fd; border:2px solid #0288d1; margin:0 auto; max-width:720px; }
  .fieldset-titulo { background:#bbdefb; padding:0.5em; border-radius:6px; font-weight:bold; font-size:1.1em; margin-bottom:0.5em; }
  .grid-parejas { display:grid; grid-template-columns:repeat(auto-fit, minmax(240px,1fr)); gap:1em; }
  .grid-parejas label { display:flex; flex-direction:column; font-size:0.95em; font-weight:bold; }
  table#med-table th, table#med-table td { border-bottom:1px solid #ccc; padding:0.3em; }
  textarea, input, select { padding:0.4em; border-radius:5px; border:1px solid #ccc; font-size:0.95em; }
  fieldset { border:1px solid #90caf9; border-radius:10px; padding:1em; margin-bottom:1.5em; background:#f1f8ff; }
  .button-86 { background:#0288d1; color:#fff; padding:0.5em 1.2em; border:none; border-radius:6px; cursor:pointer; }
  .button-86.small { font-size:0.8em; padding:0.3em 0.6em; }
  .button-86:hover { background:#0277bd; }
</style>

<script src="consulta.js"></script>
